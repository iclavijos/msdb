<div>
    <div class="row">
        <div class="col-sm-12">
            <button *jhiHasAnyAuthority="['ROLE_ADMIN', 'ROLE_EDITOR']"
                    class="btn btn-primary float-right create-event-entry" [routerLink]="['/', { outlets: { popup: eventEdition.id + '/event-entry-new' } }]">
                <span class="fa fa-plus"></span>
            </button>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="alert alert-warning" [hidden]="eventEntries && eventEntries.length > 0">
                <span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.notFound">No event entries found</span>
            </div>
            <div class="table-responsive" [hidden]="!eventEntries || eventEntries?.length === 0">
                <table mat-table class="table table-hover" multiTemplateDataRows [dataSource]="eventEntries"
                       matSortActive="raceNumber" matSortDisableClear matSortDirection="asc">

                    <ng-container matColumnDef="raceNumber">
                        <th mat-header-cell *matHeaderCellDef>{{ 'motorsportsDatabaseApp.eventEdition.entry.raceNumber' | translate }}</th>
                        <td mat-cell *matCellDef="let entry">{{ entry.raceNumber }}</td>
                    </ng-container>

                    <ng-container matColumnDef="tyres">
                        <th mat-header-cell *matHeaderCellDef>{{ 'motorsportsDatabaseApp.eventEdition.entry.tyres' | translate }}</th>
                        <td mat-cell *matCellDef="let entry">
                            <span [style.background]="entry.tyres.backgroundColor" [style.color]="entry.tyres.letterColor"
                                  style="text-align: center; line-height: 20px; width: 20px; height: 20px;"
                                  data-toggle="tooltip" data-placement="bottom" title="{{entry.tyres.name}}">
                                 {{ entry.tyres.name.substring(0,1) }}
                             </span>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="drivers">
                        <th mat-header-cell *matHeaderCellDef>{{ 'motorsportsDatabaseApp.eventEdition.entry.drivers' | translate }}</th>
                        <td mat-cell *matCellDef="let entry">
                            <div *ngIf="!entry.eventEdition.multidriver">
                                <img *ngIf="entry.drivers[0].nationality" src="/images/flags16/{{entry.drivers[0].nationality.countryCode}}.png"/>
                                <a [routerLink]="['/driver', entry.drivers[0].id, 'view' ]" >
                                    {{entry.drivers[0].fullName}}
                                </a>
                                <span *ngIf="entry.rookie"> (R)</span>
                            </div>
                            <div *ngIf="entry.eventEdition.multidriver">
                                <div *ngFor="let driver of entry.drivers">
                                    <img *ngIf="driver?.nationality" src="/images/flags16/{{driver?.nationality.countryCode}}.png"/> <span class="tag">{{ driver.fullName }}</span>
                                </div>
                            </div>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="buttons">
                        <th mat-header-cell *matHeaderCellDef></th>
                        <td mat-cell *matCellDef="let eventEntry">
                            <div class="btn-group">
                                <button type="submit"
                                        [routerLink]="['/event/edition', eventEntry.id, 'view-entry' ]"
                                        class="btn btn-info btn-xs">
                                    <fa-icon [icon]="'eye'"></fa-icon>
                                </button>
                                <button type="submit"
                                        *jhiHasAnyAuthority="['ROLE_ADMIN', 'ROLE_EDITOR']"
                                        [routerLink]="['/event/edition', eventEntry.id, 'edit-entry']"
                                        class="btn btn-primary btn-xs">
                                    <fa-icon [icon]="'pencil-alt'"></fa-icon>
                                </button>
                                <button type="submit"
                                        *jhiHasAnyAuthority="['ROLE_ADMIN']"
                                        [routerLink]="['/event/edition', { outlets: { popup: eventEdition.id + '/delete-ed'} }]"
                                        replaceUrl="true"
                                        queryParamsHandling="merge"
                                        class="btn btn-danger btn-xs">
                                    <fa-icon [icon]="'times'"></fa-icon>
                                </button>
                            </div>
                        </td>
                    </ng-container>

                    <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
                    <ng-container matColumnDef="expandedDetail">
                        <td mat-cell *matCellDef="let entry" [attr.colspan]="displayedColumns.length">
                            <div class="example-element-detail"
                                 [@detailExpand]="entry == expandedElement ? 'expanded' : 'collapsed'">
                                <div class="col-md-3">
                                    <label *ngIf="entry.team"><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.team">Team</span></label>
                                    <div *ngIf="entry.team">
                                        <a [routerLink]="['/team', entry.team?.id, 'view' ]" >
                                            <img *ngIf="entry.team?.logoUrl" [src]="entry.team.logoUrl" class="img-fluid"/>
                                            <span *ngIf="!entry.team?.logoUrl">{{entry.team?.name}}</span>
                                        </a>
                                    </div></br>
                                    <label *ngIf="entry.operatedBy"><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.operatedBy">Operated By</span></label>
                                    <label><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.chassis">Chassis</span></label>
                                    <div *ngIf="entry.chassis">
                                        <a [routerLink]="['/chassis', entry.chassis?.id, 'view' ]" >{{entry.chassis?.manufacturer}} {{entry.chassis?.name}}</a>
                                    </div></br>
                                    <label><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.engine">Engine</span></label>
                                    <div *ngIf="entry.engine">
                                        <a [routerLink]="['/engine', entry.engine?.id, 'view' ]" >{{entry.engine?.manufacturer}} {{entry.engine?.name}}</a>
                                    </div></br>
                                    <div *ngIf="entry.operatedBy">
                                        <a [routerLink]="['/team', entry.operatedBy?.id, 'view' ]" >{{entry.operatedBy?.name}}</a>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <label><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.tyres">Tyres</span></label>
                                    <div *ngIf="entry.tyres?.logoUrl">
                                        <a [routerLink]="['/tyre-provider', entry.tyres?.id, 'view' ]" >
                                            <img [src]="entry.tyres?.logoUrl" class="img-fluid" alt="tyres logo"/>
                                        </a>
                                    </div></br>
                                    <label><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.fuel">Fuel</span></label>
                                    <div *ngIf="entry.fuel">
                                        <a [routerLink]="['/fuel-provider', entry.fuel?.id, 'view' ]" >
                                            <img [src]="entry.fuel?.logoUrl" class="img-fluid" alt="fuel logo"/>
                                        </a>
                                    </div></br>
                                    <label *ngIf="eventEdition.allowedCategories.length != 1"><span jhiTranslate="motorsportsDatabaseApp.eventEdition.entry.category">Category</span></label>
                                    <div *ngIf="eventEdition.allowedCategories.length != 1">
                                        {{entry.category.shortname}}
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div *ngIf="!entry.eventEdition.multidriver">
                                        <img *ngIf="entry.drivers[0].faceUrl" [src]="getBigFaceUrl(entry.drivers[0].portraitUrl)"/>
                                    </div>
                                    <div *ngIf="entry.eventEdition.multidriver">
                                        <div class="row">
                                            <div class="col-md-2" *ngFor="let driver of entry.drivers">
                                                <figure class="figure">
                                                    <img *ngIf="driver.faceUrl" [src]="getSmallFaceUrl(driver.portraitUrl)" alt="{{ driver.fullName }}"/>
                                                    <img *ngIf="!driver.faceUrl"
                                                         [src]="getSmallFaceUrl('https://res.cloudinary.com/msdb-cloud/image/upload/v1518113603/generic.png')" alt="{{driver.fullName}}"/>
                                                    <figcaption class="figure-caption text-center">{{driver.surname}}</figcaption>
                                                </figure>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let element; columns: displayedColumns;"
                        class="example-element-row"
                        [class.example-expanded-row]="expandedElement === element"
                        (click)="expandedElement = expandedElement === element ? null : element">
                    </tr>
                    <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
                </table>
            </div>
        </div>
    </div>
</div>
